var fs = require('fs');
var path = require('path');

module.exports = exports = function(curDirPath){
  console.log(curDirPath);
  var _scanDir = function(dirpath){
    
    var results = {
        files: [],
        directories: []
    };
	
	try{
      var files = fs.readdirSync(dirpath);
      for (file of files){
        
        try{
          var fileStats = fs.statSync(path.join(dirpath, file));

          //if its'a  file and not a hidden file
          if (fileStats.isFile() && path.extname(file))
            results.files.push(file);

          else if(fileStats.isDirectory())
            results.directories.push(file);
        } catch(e){
          console.log("Issue reading file with fs.statSync: " + path.join(dirpath, file));
          console.log(e);
        }
      }
      
	} catch(e){
      console.log("Issue using fs.readdirSync on " + dirpath);
      console.log(e);
	}
    
    return results;
    
  };
  
  var walker = {
    scanDir: function(){
      return _scanDir(curDirPath);
    },
    scanChildDir: function(childdir){
      return _scanDir(path.join(curDirPath, childdir));
    },
    scanParentDir: function(){
      return _scanDir(path.dirname(curDirPath));
    },
    scanSiblingDir: function(sibdir){
      return _scanDir(path.join(path.dirname(curDirPath), sibdir));
    }
  }
  
  return walker;
};
